<!DOCTYPE html>
<html class="js svg ratio1x  appcache offline-not-installed" lang="pt-BR"><head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="referrer" content="origin"> <title>Collections framework - Java e Orientação a Objetos</title> <script src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/ga.js" async="" type="text/javascript"></script><script src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/goal.js" defer="defer" async="" type="text/javascript"></script><script>"https:"!=location.protocol&&"www.caelum.com.br"==location.hostname&&(location.href="https:"+location.href.substring(location.protocol.length)),document.documentElement.className="js "+(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect?"svg ":"no-svg ")+"ratio"+(devicePixelRatio>1.3?"2x ":"1x ")</script> <link rel="stylesheet" href="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/apostila-aberta-cf595183cb.css"> <meta property="og:title" content="Collections framework - Java e Orientação a Objetos"> <meta property="og:image" content="https://www.caelum.com.br/apostila-java-orientacao-objetos/share.png"> <meta property="og:site_name" content="Apostilas Caelum"> <meta property="fb:app_id" content="140078819399376"> <meta itemprop="name" content="Collections framework - Java e Orientação a Objetos"> <meta itemprop="image" content="https://www.caelum.com.br/apostila-java-orientacao-objetos/share.png"> <meta property="fb:url" content="https://www.caelum.com.br/apostila-java-orientacao-objetos/collections-framework/"> <link rel="canonical" href="https://www.caelum.com.br/apostila-java-orientacao-objetos/collections-framework/"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta name="apple-mobile-web-app-title" content="Java e OO"> <link rel="apple-touch-icon" href="https://www.caelum.com.br/apostila-java-orientacao-objetos/share.png"> <script>"standalone"in navigator&&navigator.standalone&&(document.documentElement.className+=" ios-webapp")</script> <script src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/apostila-aberta-46893ad681.js" async=""></script></head> <body class=""> <script>!function(a){var e=a.createElement("script");e.async=!0,e.src="/script/apostila-aberta-46893ad681.js";var t=a.getElementsByTagName("script")[0];t.parentNode.appendChild(e,t)}(document)</script> <div role="banner" class="barra-topo"> <div class="barra-offline-update"> <div class="container"> Nova versão da apostila disponível. <a href="https://www.caelum.com.br/apostila-java-orientacao-objetos/offline/">Atualizar</a> </div> </div> <div class="container barra-container"> <div class="sombra"></div> <div> <a href="http://www.caelum.com.br/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral" class="logo"> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/caelum-logo-cinza.svg" alt="Caelum" onerror='this.src=this.src.replace(".svg",".png"),this.onerror=null'> </a> <a href="https://www.caelum.com.br/apostila-java-orientacao-objetos/" class="book-title" title="Ir para Capa &amp; Sumário da apostila">Apostila Java e Orientação a Objetos</a> <div class="menu-mais"> <a href="http://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.caelum.com.br%2Fapostila-java-orientacao-objetos%2F" class="share" rel="nofollow" title="Compartilhar no Facebook"> <span aria-hidden="true" class="icone-facebook"></span> <span class="ir">Compartilhar apostila FJ-11 no Facebook</span> </a> <div class="config"> <span aria-hidden="true" class="icone-list icone" title="Opções"></span> <span tabindex="0" class="ir">Opções</span> <div class="submenu"> <section class="submenu-sub"> <h3 class="submenu-divisor submenu-label">Navegação</h3> <ul> <li> <a href="https://www.caelum.com.br/apostila-java-orientacao-objetos/" title="Ir para Capa e Sumário da apostila" class="submenu-link"> <span aria-hidden="true" class="icone icone-house"></span> <span>Capa &amp; Sumário</span> </a> </li> <li> <form> <label for="chapter-nav-select" id="chapter-nav-label" class="submenu-label">Capítulos</label> <select class="chapter-nav" title="Navegue nos capítulos da apostila" id="chapter-nav-select" aria-labeledby="chapter-nav-label"> <option></option> <option value="../como-aprender-java/"> 1. Como Aprender Java </option> <option value="../o-que-e-java/"> 2. O que é Java </option> <option value="../variaveis-primitivas-e-controle-de-fluxo/"> 3. Variáveis primitivas e Controle de fluxo </option> <option value="../orientacao-a-objetos-basica/"> 4. Orientação a objetos básica </option> <option value="../um-pouco-de-arrays/"> 5. Um pouco de arrays </option> <option value="../modificadores-de-acesso-e-atributos-de-classe/"> 6. Modificadores de acesso e atributos de classe </option> <option value="../heranca-reescrita-e-polimorfismo/"> 7. Herança, reescrita e polimorfismo </option> <option value="../eclipse-ide/"> 8. Eclipse IDE </option> <option value="../classes-abstratas/"> 9. Classes Abstratas </option> <option value="../interfaces/"> 10. Interfaces </option> <option value="../excecoes-e-controle-de-erros/"> 11. Exceções e controle de erros </option> <option value="../pacotes-organizando-suas-classes-e-bibliotecas/"> 12. Pacotes - Organizando suas classes e bibliotecas </option> <option value="../ferramentas-jar-e-javadoc/"> 13. Ferramentas: jar e javadoc </option> <option value="../o-pacote-java-lang/"> 14. O pacote java.lang </option> <option value="../pacote-java-io/"> 15. Pacote java.io </option> <option value="../collections-framework/" selected="selected"> 16. Collections framework </option> <option value="../programacao-concorrente-e-threads/"> 17. Programação Concorrente e Threads </option> <option value="../e-agora/"> 18. E agora? </option> <option value="../apendice-sockets/"> 19. Apêndice - Sockets </option> <option value="../apendice-problemas-com-concorrencia/"> 20. Apêndice - Problemas com concorrência </option> <option value="../apendice-instalacao-do-java/"> 21. Apêndice - Instalação do Java </option> <option value="../apendice-debugging/"> 22. Apêndice - Debugging </option></select> </form> </li> <li> <form action="/busca/" method="GET"> <input name="apostila" value="FJ-11" type="hidden"> <label for="apostila-busca-input" id="apostila-busca-label" class="submenu-label">Busca</label> <input id="apostila-busca-input" aria-labeledby="apostila-busca-label" name="q" type="search"> <button title="Buscar" class="search-form-action"> <span aria-hidden="true" class="icone-search"></span> <span class="ir">Buscar</span> </button> </form> </li> </ul> </section> <section class="submenu-sub"> <h3 class="submenu-divisor submenu-label">Mais</h3> <ul> <li> <a href="http://www.caelum.com.br/curso-java-orientacao-objetos/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral" title="Java e Orientação a Objetos" class="submenu-link"> <span aria-hidden="true" class="icone icone-star"></span> <span>Curso Caelum dessa apostila</span> </a> </li> <li> <a href="http://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.caelum.com.br%2Fapostila-java-orientacao-objetos%2F" rel="nofollow" class="submenu-link"> <span aria-hidden="true" class="icone icone-facebook"></span> <span>Compartilhar no Facebook</span> </a> </li> <li> <a href="https://www.caelum.com.br/apostila-java-orientacao-objetos/offline/" class="submenu-link"> <span aria-hidden="true" class="icone icone-browser"></span> <span class="novo">Leitura offline</span> </a> </li> <li> <a href="http://www.caelum.com.br/apostilas/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral#FJ-11" title="Baixe em PDF, epub e mobi" class="submenu-link"> <span aria-hidden="true" class="icone icone-install"></span> <span>Download da apostila</span> </a> </li> <li> <a href="http://www.caelum.com.br/apostilas/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral" title="Apostilas abertas da Caelum" class="submenu-link"> <span aria-hidden="true" class="icone icone-plus"></span> <span>Outras apostilas abertas</span> </a> </li> </ul> </section> </div> </div> </div> </div> </div> </div> <div role="main" class="tubaina container"> <div class="chapter-header">Capítulo <span>16</span> </div> <h1 class="chapter-title">Collections framework</h1> <p><q cite="Baron de la Brede et de Montesquieu">"A amizade é um contrato segundo o qual nos comprometemos a prestar pequenos favores para que no-los retribuam com grandes."</q></p> <p>Ao término desse capítulo, você será capaz de:</p> <ul> <li>utilizar arrays, lists, sets ou maps dependendo da necessidade do programa;</li> <li>iterar e ordenar listas e coleções;</li> <li>usar mapas para inserção e busca de objetos.</li> </ul> <section class="section" data-section="16-1-arrays-sao-trabalhosos-utilizar-estrutura-de-dados"> <a name="16-1-arrays-sao-trabalhosos-utilizar-estrutura-de-dados" class="section-anchor"></a> <h2 class="section-title"> 16.1 - Arrays são trabalhosos, utilizar estrutura de dados </h2> <p>Como vimos no capítulo de arrays, manipulá-las é bastante trabalhoso. Essa dificuldade aparece em diversos momentos:</p> <ul> <li>não podemos redimensionar um array em Java;</li> <li>é impossível buscar diretamente por um determinado elemento cujo índice não se sabe;</li> <li>não conseguimos saber quantas posições do array já foram populadas sem criar, para isso, métodos auxiliares.</li> </ul> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/array1.png" id="array1.png" alt="array1.png"> <p>Na
 figura acima, você pode ver um array que antes estava sendo 
completamente utilizado e que, depois, teve um de seus elementos 
removidos.</p> <p>Supondo que os dados armazenados representem contas, o
 que acontece quando precisarmos inserir uma nova conta no banco? 
Precisaremos procurar por um espaço vazio? Guardaremos em alguma 
estrutura de dados externa, as posições vazias? E se não houver espaço 
vazio? Teríamos de criar um array maior e copiar os dados do antigo para
 ele? </p> <p>Há mais questões: como posso saber quantas posições estão 
sendo usadas no array? Vou precisar sempre percorrer o array inteiro 
para conseguir essa informação?</p> <p>Além dessas dificuldades que os 
arrays apresentavam, faltava um conjunto robusto de classes para suprir a
 necessidade de estruturas de dados básicas, como listas ligadas e 
tabelas de espalhamento.</p> <a id="Collections"></a> <p>Com esses e outros objetivos em mente, o comitê responsável pelo Java criou um conjunto de classes e interfaces conhecido como <strong>Collections Framework</strong>, que reside no pacote <code>java.util</code> desde o Java2 1.2.</p> <div class="box"> <h4>Collections</h4> <p>A <strong>API</strong> do <strong>Collections</strong> é robusta e possui diversas classes que representam estruturas de dados avançadas.</p> <p>Por exemplo, não é necessário reinventar a roda e criar uma lista ligada, mas sim utilizar aquela que o Java disponibiliza.</p> </div> </section> <section class="section" data-section="16-2-listas-java-util-list"> <a name="16-2-listas-java-util-list" class="section-anchor"></a> <h2 class="section-title"> 16.2 - Listas: java.util.List </h2> <p>Um primeiro recurso que a API de <code>Collections</code> traz são <strong>listas</strong>. Uma lista é uma coleção que permite elementos duplicados e mantém uma ordenação específica entre os elementos.</p> <p>Em
 outras palavras, você tem a garantia de que, quando percorrer a lista, 
os elementos serão encontrados em uma ordem pré-determinada, definida na
 hora da inserção dos mesmos. Ela resolve todos os problemas que 
levantamos em relação ao array (busca, remoção, tamanho "infinito",...).
 Esse código já está pronto!</p> <p>A API de <code>Collections</code> traz a interface <code>java.util.List</code>,
 que especifica o que uma classe deve ser capaz de fazer para ser uma 
lista. Há diversas implementações disponíveis, cada uma com uma forma 
diferente de representar uma lista.</p> <p>A implementação mais utilizada da interface <code>List</code> é a <code>ArrayList</code>, que trabalha com um array interno para gerar uma lista. Portanto, ela é mais rápida na pesquisa do que sua concorrente, a <code>LinkedList</code>, que é mais rápida na inserção e remoção de itens nas pontas.</p> <div class="box"> <h4>ArrayList não é um array!</h4> <p>É comum confundirem uma <code>ArrayList</code>
 com um array, porém ela não é um array. O que ocorre é que, 
internamente, ela usa um array como estrutura para armazenar os dados, 
porém este atributo está propriamente encapsulado e você não tem como 
acessá-lo. Repare, também, que você não pode usar <code>[]</code> com uma <code>ArrayList</code>, nem acessar atributo <code>length</code>. Não há relação!</p> </div> <p>Para criar um <code>ArrayList</code>, basta chamar o construtor:</p> <pre><div class="highlight"><pre><span class="n">ArrayList</span> <span class="n">lista</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
</pre></div></pre> <p>É sempre possível abstrair a lista a partir da interface <code>List</code>:</p> <pre><div class="highlight"><pre><span class="n">List</span> <span class="n">lista</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
</pre></div></pre> <p>Para criar uma lista de nomes (<code>String</code>), podemos fazer:</p> <pre><div class="highlight"><pre><span class="n">List</span> <span class="n">lista</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Manoel"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Joaquim"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Maria"</span><span class="o">);</span>
</pre></div></pre> <p>A interface <code>List</code> possui dois métodos <code>add</code>,
 um que recebe o objeto a ser inserido e o coloca no final da lista, e 
um segundo que permite adicionar o elemento em qualquer posição da 
mesma. Note que, em momento algum, dizemos qual é o tamanho da lista; 
podemos acrescentar quantos elementos quisermos, que a lista cresce 
conforme for necessário.</p> <p>Toda lista (na verdade, toda <code>Collection</code>) trabalha do modo mais genérico possível. Isto é, não há uma <code>ArrayList</code> específica para <code>Strings</code>, outra para Números, outra para Datas etc. Todos os métodos trabalham com <code>Object</code>.</p> <p>Assim, é possível criar, por exemplo, uma lista de Contas Correntes:</p> <pre><div class="highlight"><pre><span class="n">ContaCorrente</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
<span class="n">c1</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="n">ContaCorrente</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
<span class="n">c2</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">200</span><span class="o">);</span>

<span class="n">ContaCorrente</span> <span class="n">c3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
<span class="n">c3</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">300</span><span class="o">);</span>

<span class="n">List</span> <span class="n">contas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c1</span><span class="o">);</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c3</span><span class="o">);</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>
</pre></div></pre> <p>Para saber quantos elementos há na lista, usamos o método <code>size()</code>:</p> <pre><div class="highlight"><pre><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">contas</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
</pre></div></pre> <p>Há ainda um método <code>get(int)</code> que recebe como argumento o índice do elemento que se quer recuperar. Através dele, podemos fazer um <code>for</code> para iterar na lista de contas:</p> <pre><div class="highlight"><pre><span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">contas</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">contas</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span> <span class="c1">// código não muito útil....</span>
<span class="o">}</span>
</pre></div></pre> <p>Mas como fazer para imprimir o saldo dessas contas? Podemos acessar o <code>getSaldo()</code> diretamente após fazer <code>contas.get(i)</code>? Não podemos; lembre-se que toda lista trabalha sempre com <code>Object</code>. Assim, a referência devolvida pelo <code>get(i)</code> é do tipo <code>Object</code>, sendo necessário o cast para <code>ContaCorrente</code> se quisermos acessar o <code>getSaldo()</code>:</p> <pre><div class="highlight"><pre><span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">contas</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">ContaCorrente</span> <span class="n">cc</span> <span class="o">=</span> <span class="o">(</span><span class="n">ContaCorrente</span><span class="o">)</span> <span class="n">contas</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cc</span><span class="o">.</span><span class="na">getSaldo</span><span class="o">());</span>
<span class="o">}</span>
<span class="c1">// note que a ordem dos elementos não é alterada</span>
</pre></div></pre> <p>Há ainda outros métodos, como <code>remove()</code> que recebe um objeto que se deseja remover da lista; e <code>contains()</code>, que recebe um objeto como argumento e devolve <code>true</code> ou <code>false</code>, indicando se o elemento está ou não na lista.</p> <p>A interface <code>List</code> e algumas classes que a implementam podem ser vistas no diagrama a seguir:</p> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/list.png" id="list.png" alt="list.png"> <div class="box"> <h4>Acesso aleatório e percorrendo listas com get</h4> <p>Algumas listas, como a <code>ArrayList</code>,
 têm acesso aleatório aos seus elementos: a busca por um elemento em uma
 determinada posição é feita de maneira imediata, sem que a lista 
inteira seja percorrida (que chamamos de acesso sequencial).</p> <p>Neste caso, o acesso através do método <code>get(int)</code> é muito rápido. Caso contrário, percorrer uma lista usando um <code>for</code> como esse que acabamos de ver, pode ser desastroso. Ao percorrermos uma lista, devemos usar <strong>sempre</strong> um <code>Iterator</code> ou <code>enhanced for</code>, como veremos.</p> </div> <p>Uma
 lista é uma excelente alternativa a um array comum, já que temos todos 
os benefícios de arrays, sem a necessidade de tomar cuidado com 
remoções, falta de espaço etc.</p> <p>A outra implementação muito usada, a <code>LinkedList</code>,
 fornece métodos adicionais para obter e remover o primeiro e último 
elemento da lista. Ela também tem o funcionamento interno diferente, o 
que pode impactar performance, como veremos durante os exercícios no 
final do capítulo.</p> <div class="box"> <h4>Vector</h4> <p>Outra implementação é a tradicional classe <code>Vector</code>, presente desde o Java 1.0, que foi adaptada para uso com o framework de Collections, com a inclusão de novos métodos.</p> <p>Ela
 deve ser escolhida com cuidado, pois lida de uma maneira diferente com 
processos correndo em paralelo e terá um custo adicional em relação a <code>ArrayList</code> quando não houver acesso simultâneo aos dados.</p> </div> </section><div class="anuncio"> <a href="https://www.alura.com.br/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral" title="Cursos online Alura"> <h4>Agora é a melhor hora de aprender algo novo</h4> <img class="icone" src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/alura_2x.png" aria-hidden="true" width="120"> <p>Se você gosta de estudar essa apostila aberta da Caelum, certamente vai gostar dos <strong>cursos online</strong> que lançamos na plataforma <b>Alura</b>. Você estuda a qualquer momento com a <strong>qualidade</strong> Caelum.</p> <p><span class="action">Conheça a Alura</span>.</p> </a> </div> <section class="section" data-section="16-3-listas-no-java-5-e-java-7-com-generics"> <a name="16-3-listas-no-java-5-e-java-7-com-generics" class="section-anchor"></a> <h2 class="section-title"> 16.3 - Listas no Java 5 e Java 7 com Generics </h2> <p>Em qualquer lista, é possível colocar qualquer <code>Object</code>. Com isso, é possível misturar objetos:</p> <pre><div class="highlight"><pre><span class="n">ContaCorrente</span> <span class="n">cc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>

<span class="n">List</span> <span class="n">lista</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Uma string"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">cc</span><span class="o">);</span>
<span class="o">...</span>
</pre></div></pre> <p>Mas e depois, na hora de recuperar esses objetos? Como o método <code>get</code> devolve um <code>Object</code>, precisamos fazer o cast. Mas com uma lista com vários objetos de tipos diferentes, isso pode não ser tão simples...</p> <p>Geralmente,
 não nos interessa uma lista com vários tipos de objetos misturados; no 
dia-a-dia, usamos listas como aquela de contas correntes. No Java 5.0, 
podemos usar o recurso de Generics para restringir as listas a um 
determinado tipo de objetos (e não qualquer <code>Object</code>):</p> <pre><div class="highlight"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">ContaCorrente</span><span class="o">&gt;</span> <span class="n">contas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">ContaCorrente</span><span class="o">&gt;();</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c1</span><span class="o">);</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c3</span><span class="o">);</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>
</pre></div></pre> <p>Repare no uso de um parâmetro ao lado de <code>List</code> e <code>ArrayList</code>: ele indica que nossa lista foi criada para trabalhar exclusivamente com objetos do tipo <code>ContaCorrente</code>. Isso nos traz uma segurança em tempo de compilação:</p> <pre><div class="highlight"><pre><span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"uma string"</span><span class="o">);</span> <span class="c1">// isso não compila mais!!</span>
</pre></div></pre> <p>O uso de Generics também elimina a necessidade de 
casting, já que, seguramente, todos os objetos inseridos na lista serão 
do tipo <code>ContaCorrente</code>:</p> <pre><div class="highlight"><pre><span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">contas</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">ContaCorrente</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">contas</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span> <span class="c1">// sem casting!</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cc</span><span class="o">.</span><span class="na">getSaldo</span><span class="o">());</span>
<span class="o">}</span>
</pre></div></pre> <p>A partir do Java 7, se você instancia um tipo 
genérico na mesma linha de sua declaração, não é necessário passar os 
tipos novamente, basta usar <code>new ArrayList&lt;&gt;()</code>. É conhecido como <em>operador diamante</em>:</p> <pre><div class="highlight"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">ContaCorrente</span><span class="o">&gt;</span> <span class="n">contas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</pre></div></pre> </section> <section class="section" data-section="16-4-a-importancia-das-interfaces-nas-colecoes"> <a name="16-4-a-importancia-das-interfaces-nas-colecoes" class="section-anchor"></a> <h2 class="section-title"> 16.4 - A importância das interfaces nas coleções </h2> <p>Vale ressaltar a importância do uso da interface <code>List</code>:
 quando desenvolvemos, procuramos sempre nos referir a ela, e não às 
implementações específicas. Por exemplo, se temos um método que vai 
buscar uma série de contas no banco de dados, poderíamos fazer assim:</p> <pre><div class="highlight"><pre><span class="kd">class</span> <span class="nc">Agencia</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Conta</span><span class="o">&gt;</span> <span class="n">buscaTodasContas</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Conta</span><span class="o">&gt;</span> <span class="n">contas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="c1">// para cada conta do banco de dados, contas.add</span>
    
    <span class="k">return</span> <span class="n">contas</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Porém, para que precisamos retornar a referência específica a uma <code>ArrayList</code>? Para que ser tão específico? Dessa maneira, o dia que optarmos por devolver uma <code>LinkedList</code> em vez de <code>ArrayList</code>, as pessoas que estão usando o método <code>buscaTodasContas</code> poderão ter problemas, pois estavam fazendo referência a uma <code>ArrayList</code>. O ideal é sempre trabalhar com a interface mais genérica possível:</p> <pre><div class="highlight"><pre><span class="kd">class</span> <span class="nc">Agencia</span> <span class="o">{</span>

  <span class="c1">// modificação apenas no retorno:</span>
  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Conta</span><span class="o">&gt;</span> <span class="n">buscaTodasContas</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Conta</span><span class="o">&gt;</span> <span class="n">contas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="c1">// para cada conta do banco de dados, contas.add</span>
    
    <span class="k">return</span> <span class="n">contas</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>É o mesmo caso de preferir referenciar aos objetos com <code>InputStream</code> como fizemos no capítulo passado.</p> <p>Assim
 como no retorno, é boa prática trabalhar com a interface em todos os 
lugares possíveis: métodos que precisam receber uma lista de objetos têm
 <code>List</code> como parâmetro em vez de uma implementação em específico como <code>ArrayList</code>, deixando o método mais flexível:</p> <pre><div class="highlight"><pre><span class="kd">class</span> <span class="nc">Agencia</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">atualizaContas</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Conta</span><span class="o">&gt;</span> <span class="n">contas</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Também declaramos atributos como <code>List</code> em vez de nos comprometer como uma ou outra implementação. Dessa forma obtemos um <strong>baixo acoplamento</strong>: podemos trocar a implementação, já que estamos programando para a interface! Por exemplo:</p> <pre><div class="highlight"><pre><span class="kd">class</span> <span class="nc">Empresa</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Funcionario</span><span class="o">&gt;</span> <span class="n">empregados</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

  <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div></pre> </section> <section class="section" data-section="16-5-ordenacao-collections-sort"> <a name="16-5-ordenacao-collections-sort" class="section-anchor"></a> <h2 class="section-title"> 16.5 - Ordenação: Collections.sort </h2> <p>Vimos
 anteriormente que as listas são percorridas de maneira pré-determinada 
de acordo com a inclusão dos itens. Mas, muitas vezes, queremos 
percorrer a nossa lista de maneira ordenada.</p> <p>A classe <code>Collections</code> traz um método estático <code>sort</code> que recebe um <code>List</code> como argumento e o ordena por ordem crescente. Por exemplo:</p> <pre><div class="highlight"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lista</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Sérgio"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Paulo"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Guilherme"</span><span class="o">);</span>

<span class="c1">// repare que o toString de ArrayList foi sobrescrito:</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lista</span><span class="o">);</span> 

<span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">lista</span><span class="o">);</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lista</span><span class="o">);</span>
</pre></div></pre> <p>Ao testar o exemplo acima, você observará que, primeiro, a lista é impressa na ordem de inserção e, depois de invocar o <code>sort</code>, ela é impressa em ordem alfabética.</p> <p>Mas toda lista em Java pode ser de qualquer tipo de objeto, por exemplo, <code>ContaCorrente</code>. E se quisermos ordenar uma lista de <code>ContaCorrente</code>? Em que ordem a classe <code>Collections</code> ordenará? Pelo saldo? Pelo nome do correntista?</p> <pre><div class="highlight"><pre><span class="n">ContaCorrente</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
<span class="n">c1</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">500</span><span class="o">);</span>

<span class="n">ContaCorrente</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
<span class="n">c2</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">200</span><span class="o">);</span>

<span class="n">ContaCorrente</span> <span class="n">c3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
<span class="n">c3</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">150</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">ContaCorrente</span><span class="o">&gt;</span> <span class="n">contas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c1</span><span class="o">);</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c3</span><span class="o">);</span>
<span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>

<span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">contas</span><span class="o">);</span> <span class="c1">// qual seria o critério para esta ordenação?</span>
</pre></div></pre> <p>Sempre que falamos em ordenação, precisamos pensar em um <strong>critério de ordenação</strong>, uma forma de determinar qual elemento vem antes de qual. É necessário instruir o <code>sort</code> sobre como <strong>comparar</strong> nossas <code>ContaCorrente</code> a fim de determinar uma ordem na lista. Para isto, o método <code>sort</code> necessita que todos seus objetos da lista sejam <strong>comparáveis</strong> e possuam um método que se compara com outra <code>ContaCorrente</code>. Como é que o método <code>sort</code> terá a garantia de que a sua classe possui esse método? Isso será feito, novamente, através de um contrato, de uma interface!</p> <a id="Comparable"></a> <p>Vamos fazer com que os elementos da nossa coleção implementem a interface <code>java.lang.Comparable</code>, que define o método <code>int compareTo(Object)</code>. Este método deve retornar <strong>zero</strong>, se o objeto comparado for <strong>igual</strong> a este objeto, um número <strong>negativo</strong>, se este objeto for <strong>menor</strong> que o objeto dado, e um número <strong>positivo</strong>, se este objeto for <strong>maior</strong> que o objeto dado.</p> <p>Para ordenar as <code>ContaCorrente</code>s por saldo, basta implementar o <code>Comparable</code>:</p> <pre><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ContaCorrente</span> <span class="kd">extends</span> <span class="n">Conta</span> 
            <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">ContaCorrente</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="c1">// ... todo o código anterior fica aqui</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">ContaCorrente</span> <span class="n">outra</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">saldo</span> <span class="o">&lt;</span> <span class="n">outra</span><span class="o">.</span><span class="na">saldo</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">saldo</span> <span class="o">&gt;</span> <span class="n">outra</span><span class="o">.</span><span class="na">saldo</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Com o código anterior, nossa classe tornou-se "<strong>comparável</strong>":
 dados dois objetos da classe, conseguimos dizer se um objeto é maior, 
menor ou igual ao outro, segundo algum critério por nós definido. No 
nosso caso, a comparação será feita baseando-se no saldo da conta.</p> <p>Repare
 que o critério de ordenação é totalmente aberto, definido pelo 
programador. Se quisermos ordenar por outro atributo (ou até por uma 
combinação de atributos), basta modificar a implementação do método <code>compareTo</code> na classe.</p> <p>Quando chamarmos o método <code>sort</code> de <code>Collections</code>, ele saberá como fazer a ordenação da lista; ele usará o critério que definimos no método <code>compareTo</code>.</p> <p>Mas,
 e o exemplo anterior, com uma lista de Strings? Por que a ordenação 
funcionou, naquele caso, sem precisarmos fazer nada? Simples: quem 
escreveu a classe <code>String</code> (lembre que ela é uma classe como qualquer outra) implementou a interface <code>Comparable</code> e o método <code>compareTo</code> para <code>String</code>s, fazendo comparação em ordem alfabética. (Consulte a documentação da classe <code>String</code> e veja o método <code>compareTo</code> lá). O mesmo acontece com outras classes como <code>Integer</code>, <code>BigDecimal</code>, <code>Date</code>, entre outras.</p> <div class="box"> <h4>Outros métodos da classe Collections</h4> <p>A classe <code>Collections</code> traz uma grande quantidade de métodos estáticos úteis na manipulação de coleções.</p> <ul> <li> <code>binarySearch(List, Object)</code>:
 Realiza uma busca binária por determinado elemento na lista ordenada e 
retorna sua posição ou um número negativo, caso não encontrado.</li> <li> <code>max(Collection)</code>: Retorna o maior elemento da coleção.</li> <li> <code>min(Collection)</code>: Retorna o menor elemento da coleção.</li> <li> <code>reverse(List)</code>: Inverte a lista.</li> <li>...e muitos outros. Consulte a documentação para ver outros métodos.</li> </ul> <p>No Java 8 muitas dessas funcionalidades da <code>Collections</code> podem ser feitas através dos chamados <code>Streams</code>, que fica um pouco fora do escopo de um curso inicial de Java.</p> <p>Existe uma classe análoga, a <code>java.util.Arrays</code>, que faz operações similares com arrays.</p> <p>É importante conhecê-las para evitar escrever código já existente.</p> </div> </section><div class="anuncio"> <a href="http://www.caelum.com.br/curso-java-orientacao-objetos/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral" title="Curso Java e Orientação a Objetos"> <h4>Você pode também fazer o curso FJ-11 dessa apostila na Caelum</h4> <img class="icone" src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/caelum_2x.png" aria-hidden="true" width="100"> <p>Querendo
 aprender ainda mais sobre Java e boas práticas de orientação a objetos?
 Esclarecer dúvidas dos exercícios? Ouvir explicações detalhadas com um 
instrutor?<br>A Caelum oferece o <strong>curso FJ-11</strong> presencial nas cidades de São Paulo, Rio de Janeiro e Brasília, além de turmas incompany.</p> <p><span class="action">Consulte as vantagens do curso <em>Java e Orientação a Objetos</em></span>.</p> </a> </div> <section class="section" data-section="16-6-exercicios-ordenacao"> <a name="16-6-exercicios-ordenacao" class="section-anchor"></a> <h2 class="section-title"> 16.6 - Exercícios: Ordenação </h2> <ol class="exercise"> <li class="question"> <p>Abra sua classe <code>Conta</code> e veja se ela possui o atributo <code>numero</code>. Se não possuir, adicione-o:</p> <pre><div class="highlight"><pre><span class="kd">protected</span> <span class="kt">int</span> <span class="n">numero</span><span class="o">;</span>
</pre></div></pre> <p>E gere o getter pelo Eclipse, caso necessário.</p> </li> <li class="question"> <p>Faça sua classe <code>ContaPoupanca</code> implementar a interface <code>Comparable&lt;ContaPoupanca&gt;</code>. Utilize o critério de ordenar pelo número da conta ou pelo seu saldo (como visto no código deste capítulo).</p> <pre><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ContaPoupanca</span> <span class="kd">extends</span> <span class="n">Conta</span> 
        <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">ContaPoupanca</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div></pre> <p>Repare que o Eclipse prontamente lhe oferecerá um 
quickfix, oferecendo a criação do esqueleto dos métodos definidos na 
interface <code>Comparable</code>:</p> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/comparable.png" id="comparable.png" alt="comparable.png"><p>Deixe o seu método <code>compareTo</code> parecido com este:</p> <pre><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ContaPoupanca</span> <span class="kd">extends</span> <span class="n">Conta</span>
      <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">ContaPoupanca</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="c1">// ... todo o código anterior fica aqui</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">ContaPoupanca</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getNumero</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">o</span><span class="o">.</span><span class="na">getNumero</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span> 
    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getNumero</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">o</span><span class="o">.</span><span class="na">getNumero</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span> 
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <div class="box"> <h4>Outra implementação...</h4> <p>O que acha da implementação abaixo?</p> <pre><div class="highlight"><pre><span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">ContaPoupanca</span> <span class="n">outra</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getNumero</span><span class="o">(),</span> <span class="n">outra</span><span class="o">.</span><span class="na">getNumero</span><span class="o">());</span>
<span class="o">}</span>
</pre></div></pre> </div> </li> <li class="question"> <p>Crie uma classe <code>TestaOrdenacao</code>, onde você vai instanciar diversas contas e adicioná-las a uma <code>List&lt;ContaPoupanca&gt;</code>. Use o <code>Collections.sort()</code> nessa lista:</p> <pre><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestaOrdenacao</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">ContaPoupanca</span><span class="o">&gt;</span> <span class="n">contas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="n">ContaPoupanca</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaPoupanca</span><span class="o">();</span>
    <span class="n">c1</span><span class="o">.</span><span class="na">setNumero</span><span class="o">(</span><span class="mi">1973</span><span class="o">);</span>
    <span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c1</span><span class="o">);</span>

    <span class="n">ContaPoupanca</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaPoupanca</span><span class="o">();</span>
    <span class="n">c2</span><span class="o">.</span><span class="na">setNumero</span><span class="o">(</span><span class="mi">1462</span><span class="o">);</span>
    <span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>

    <span class="n">ContaPoupanca</span> <span class="n">c3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaPoupanca</span><span class="o">();</span>
    <span class="n">c3</span><span class="o">.</span><span class="na">setNumero</span><span class="o">(</span><span class="mi">1854</span><span class="o">);</span>
    <span class="n">contas</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c3</span><span class="o">);</span>

    <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">contas</span><span class="o">);</span>  
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Faça um laço para imprimir todos os números das contas na lista já ordenada:</p> <pre><div class="highlight"><pre><span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">contas</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">Conta</span> <span class="n">atual</span> <span class="o">=</span> <span class="n">contas</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"numero: "</span> <span class="o">+</span> <span class="n">atual</span><span class="o">.</span><span class="na">getNumero</span><span class="o">());</span>
<span class="o">}</span>
</pre></div></pre> <p><strong>Atenção especial</strong>: repare que escrevemos um método <code>compareTo</code> em nossa classe e nosso código <strong>nunca</strong>
 o invoca!! Isto é muito comum. Reescrevemos (ou implementamos) um 
método e quem o invocará será um outro conjunto de classes (nesse caso, 
quem está chamando o <code>compareTo</code> é o <code>Collections.sort</code>,
 que o usa como base para o algoritmo de ordenação). Isso cria um 
sistema extremamente coeso e, ao mesmo tempo, com baixo acoplamento: a 
classe <code>Collections</code> nunca imaginou que ordenaria objetos do tipo <code>ContaPoupanca</code>, mas já que eles são <code>Comparable</code>, o seu método <code>sort</code> está satisfeito.</p> <p>Você poderia escrever o <code>for</code> acima de uma maneira mais sucinta:</p> <pre><div class="highlight"><pre><span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">contas</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"numero: "</span> <span class="o">+</span> <span class="n">contas</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getNumero</span><span class="o">());</span>
<span class="o">}</span>
</pre></div></pre> </li> <li class="question"> <p>O que teria acontecido se a classe <code>ContaPoupanca</code> não implementasse <code>Comparable&lt;ContaPoupanca&gt;</code> mas tivesse o método <code>compareTo</code>? </p> <p>Faça um teste: remova temporariamente a sentença <code>implements Comparable&lt;ContaPoupanca&gt;</code>, não remova o método <code>compareTo</code> e veja o que acontece. Basta ter o método, sem assinar a interface?</p> </li> <li class="question"> <p>Utilize uma <code>LinkedList</code> em vez de <code>ArrayList</code>:</p> <pre><div class="highlight"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">ContaPoupanca</span><span class="o">&gt;</span> <span class="n">contas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;&gt;();</span>
</pre></div></pre> <p>Precisamos alterar mais algum código para que essa substituição funcione? Rode o programa. Alguma diferença?</p> </li> <li class="question"> <p>Como
 posso inverter a ordem de uma lista? Como posso embaralhar todos os 
elementos de uma lista? Como posso rotacionar os elementos de uma lista?
 </p> <p>Investigue a documentação da classe <code>Collections</code> dentro do pacote <code>java.util</code>.</p> </li> <li class="question"><p>(opcional) Se preferir, insira novas contas através de um laço (<code>for</code>). Adivinhe o nome da classe para colocar saldos aleatórios? <code>Random</code>. Do pacote <code>java.util</code>. Consulte sua documentação para usá-la (utilize o método <code>nextInt()</code> passando o número máximo a ser sorteado).</p></li> <li class="question"> <p>(opcional) Imprima a referência para essa lista. Repare que o <code>toString</code> de uma <code>ArrayList</code>/<code>LinkedList</code> é reescrito?</p> <pre><div class="highlight"><pre><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">contas</span><span class="o">);</span>
</pre></div></pre> </li> <li class="question"> <p>(opcional) Mude o critério de comparação da sua <code>ContaPoupanca</code>. Adicione um atributo <code>nomeDoCliente</code> na sua classe (caso ainda não exista algo semelhante) e tente mudar o <code>compareTo</code> para que uma lista de <code>ContaPoupanca</code> seja ordenada alfabeticamente pelo atributo <code>nomeDoCliente</code>.</p> <p>Teste a ordenação.</p> </li> </ol> </section> <section class="section" data-section="16-7-conjunto-java-util-set"> <a name="16-7-conjunto-java-util-set" class="section-anchor"></a> <h2 class="section-title"> 16.7 - Conjunto: java.util.Set </h2> <a id="SET"></a> <p>Um conjunto (<code>Set</code>) funciona de forma análoga aos conjuntos da matemática, ele é uma coleção que não permite elementos duplicados. </p> <p>Outra
 característica fundamental dele é o fato de que a ordem em que os 
elementos são armazenados pode não ser a ordem na qual eles foram 
inseridos no conjunto. A interface não define como deve ser este 
comportamento. Tal ordem varia de implementação para implementação.</p> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/conjunto.png" id="conjunto.png" alt="conjunto.png"> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/set.png" id="set.png" alt="set.png"> <p>Um conjunto é representado pela interface <code>Set</code> e tem como suas principais implementações as classes <code>HashSet</code>, <code>LinkedHashSet</code> e <code>TreeSet</code>.</p> <p>O código a seguir cria um conjunto e adiciona diversos elementos, e alguns repetidos:</p> <pre><div class="highlight"><pre><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">cargos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;&gt;();</span>

<span class="n">cargos</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Gerente"</span><span class="o">);</span>
<span class="n">cargos</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Diretor"</span><span class="o">);</span>
<span class="n">cargos</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Presidente"</span><span class="o">);</span>
<span class="n">cargos</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Secretária"</span><span class="o">);</span>
<span class="n">cargos</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Funcionário"</span><span class="o">);</span>
<span class="n">cargos</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Diretor"</span><span class="o">);</span> <span class="c1">// repetido!</span>

<span class="c1">// imprime na tela todos os elementos</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cargos</span><span class="o">);</span>
</pre></div></pre> <p>Aqui, o segundo <code>Diretor</code> não será adicionado e o método <code>add</code> lhe retornará <code>false</code>.</p> <p>O uso de um <code>Set</code>
 pode parecer desvantajoso, já que ele não armazena a ordem, e não 
aceita elementos repetidos. Não há métodos que trabalham com índices, 
como o <code>get(int)</code> que as listas possuem. A grande vantagem do <code>Set</code> é que existem implementações, como a <code>HashSet</code>, que possui uma performance incomparável com as <code>List</code>s quando usado para pesquisa (método <code>contains</code> por exemplo). Veremos essa enorme diferença durante os exercícios.</p> <div class="box"> <h4>Ordem de um Set</h4> <p>Seria possível usar uma outra implementação de conjuntos, como um <code>TreeSet</code>,
 que insere os elementos de tal forma que, quando forem percorridos, 
eles apareçam em uma ordem definida pelo método de comparação entre seus
 elementos. Esse método é definido pela interface <code>java.lang.Comparable</code>. Ou, ainda, pode se passar um <code>Comparator</code> para seu construtor.</p> <p>Já o <code>LinkedHashSet</code> mantém a ordem de inserção dos elementos.</p> </div> <p>Antes do Java 5, não podíamos utilizar generics, e usávamos o <code>Set</code> de forma que ele trabalhava com <code>Object</code>, havendo necessidade de castings.</p> </section> <section class="section" data-section="16-8-principais-interfaces-java-util-collection"> <a name="16-8-principais-interfaces-java-util-collection" class="section-anchor"></a> <h2 class="section-title"> 16.8 - Principais interfaces: java.util.Collection </h2> <p>As coleções têm como base a interface <code>Collection</code>,
 que define métodos para adicionar e remover um elemento, e verificar se
 ele está na coleção, entre outras operações, como mostra a tabela a 
seguir:</p> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/metodos-collection.png" id="metodos-collection.png" alt="metodos-collection.png"> <p>Uma coleção pode implementar diretamente a interface <code>Collection</code>, porém normalmente se usa uma das duas subinterfaces mais famosas: justamente <code>Set</code> e <code>List</code>.</p> <p>A interface <code>Set</code>, como previamente vista, define um conjunto de elementos únicos enquanto a interface <code>List</code> permite elementos duplicados, além de manter a ordem a qual eles foram adicionados.</p> <p>A busca em um <code>Set</code> pode ser mais rápida do que em um objeto do tipo <code>List</code>, pois diversas implementações utilizam-se de tabelas de espalhamento (<em>hash tables</em>), realizando a busca para tempo linear (<strong>O(1)</strong>).</p> <a id="MAP"></a> <p>A interface <code>Map</code> faz parte do framework, mas não estende <code>Collection</code>. (veremos <code>Map</code> mais adiante).</p> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/collection-map.png" id="collection-map.png" alt="collection-map.png"> <p>No Java 5, temos outra interface filha de <code>Collection</code>: a <code>Queue</code>,
 que define métodos de entrada e de saída e cujo critério será definido 
pela sua implementação (por exemplo LIFO, FIFO ou ainda um heap onde 
cada elemento possui sua chave de prioridade).</p> </section><div class="anuncio"> <a href="http://www.guj.com.br/" title="GUJ Perguntas" rel="nofollow"> <h4>Tire suas dúvidas no GUJ Respostas</h4> <img class="icone" src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/guj_2x.png" aria-hidden="true" width="100"> <p>O
 GUJ é um dos principais fóruns brasileiros de computação e o maior em 
português sobre Java. A nova versão do GUJ é baseada em uma ferramenta 
de <i>perguntas e respostas</i> (QA) e tem uma comunidade muito forte. São mais de 150 mil usuários pra ajudar você a esclarecer suas dúvidas.</p> <p><span class="action">Faça sua pergunta</span>.</p> </a> </div> <section class="section" data-section="16-9-percorrendo-colecoes-no-java-5"> <a name="16-9-percorrendo-colecoes-no-java-5" class="section-anchor"></a> <h2 class="section-title"> 16.9 - Percorrendo coleções no Java 5 </h2> <p>Como percorrer os elementos de uma coleção? Se for uma lista, podemos sempre utilizar um laço <code>for</code>, invocando o método <code>get</code> para cada elemento. Mas e se a coleção não permitir indexação?</p> <p>Por exemplo, um <code>Set</code>
 não possui um método para pegar o primeiro, o segundo ou o quinto 
elemento do conjunto, já que um conjunto não possui o conceito de 
"ordem"</p> <p>Podemos usar o <strong>enhanced-for</strong> (o "foreach") do Java 5 para percorrer qualquer <code>Collection</code> sem nos preocupar com isso. Internamente o compilador vai fazer com que seja usado o <code>Iterator</code> da <code>Collection</code> dada para percorrer a coleção. Repare:</p> <pre><div class="highlight"><pre><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">conjunto</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;&gt;();</span>

<span class="n">conjunto</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"java"</span><span class="o">);</span>
<span class="n">conjunto</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"vraptor"</span><span class="o">);</span>
<span class="n">conjunto</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"scala"</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">palavra</span> <span class="o">:</span> <span class="n">conjunto</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">palavra</span><span class="o">);</span>
<span class="o">}</span>
</pre></div></pre> <p>Em que ordem os elementos serão acessados?</p> <p>Numa
 lista, os elementos aparecerão de acordo com o índice em que foram 
inseridos, isto é, de acordo com o que foi pré-determinado. Em um 
conjunto, a ordem depende da implementação da interface <code>Set</code>: você muitas vezes não vai saber ao certo em que ordem os objetos serão percorridos.</p> <p>Por que o <code>Set</code> é, então, tão importante e usado?</p> <p>Para perceber se um item já existe em uma lista, é muito mais rápido usar algumas implementações de <code>Set</code> do que um <code>List</code>, e os <code>TreeSets</code> já vêm ordenados de acordo com as características que desejarmos! Sempre considere usar um <code>Set</code> se não houver a necessidade de guardar os elementos em determinada ordem e buscá-los através de um índice. </p> <p>No eclipse, você pode escrever <code>foreach</code> e dar <strong>ctrl+espaço</strong>, que ele vai gerar o esqueleto desse enhanced for! Muito útil!</p> </section> <section class="section" data-section="16-10-para-saber-mais-iterando-sobre-colecoes-com-java-util-iterator"> <a name="16-10-para-saber-mais-iterando-sobre-colecoes-com-java-util-iterator" class="section-anchor"></a> <h2 class="section-title"> 16.10 - Para saber mais: Iterando sobre coleções com java.util.Iterator </h2> <p>Antes do Java 5 introduzir o novo enhanced-for, iterações em coleções eram feitas com o <code>Iterator</code>. Toda coleção fornece acesso a um <em>iterator</em>, um objeto que implementa a interface <code>Iterator</code>, que conhece internamente a coleção e dá acesso a todos os seus elementos, como a figura abaixo mostra.</p> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/iterator.png" id="iterator.png" alt="iterator.png"> <p>Ainda hoje (depois do Java 5) podemos usar o <code>Iterator</code>,
 mas o mais comum é usar o enhanced-for. E, na verdade, o enhanced-for é
 apenas um açúcar sintático que usa iterator por trás dos panos.</p> <a id="ITERATOR"></a> <p>Primeiro criamos um <code>Iterator</code> que entra na coleção. A cada chamada do método <code>next</code>, o <code>Iterator</code> retorna o próximo objeto do conjunto. Um <code>iterator</code> pode ser obtido com o método <code>iterator()</code> de <code>Collection</code>, por exemplo numa lista de <code>String</code>:</p> <pre><div class="highlight"><pre><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">lista</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
</pre></div></pre> <p>A interface <code>Iterator</code> possui dois métodos principais: <code>hasNext()</code> (com retorno booleano), indica se ainda existe um elemento a ser percorrido; <code>next()</code>, retorna o próximo objeto.</p> <p>Voltando ao exemplo do conjunto de strings, vamos percorrer o conjunto:</p> <pre><div class="highlight"><pre><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">conjunto</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;&gt;();</span>
<span class="n">conjunto</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"item 1"</span><span class="o">);</span>
<span class="n">conjunto</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"item 2"</span><span class="o">);</span>
<span class="n">conjunto</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"item 3"</span><span class="o">);</span>

<span class="c1">// retorna o iterator</span>
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">conjunto</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
<span class="k">while</span> <span class="o">(</span><span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
  <span class="c1">// recebe a palavra</span>
  <span class="n">String</span> <span class="n">palavra</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">palavra</span><span class="o">);</span>
<span class="o">}</span>
</pre></div></pre> <p>O <code>while</code> anterior só termina quando todos os elementos do conjunto forem percorridos, isto é, quando o método <code>hasNext</code> mencionar que não existem mais itens.</p> <div class="box"> <h4>ListIterator</h4> <p>Uma lista fornece, além de acesso a um <code>Iterator</code>, um <code>ListIterator</code>, que oferece recursos adicionais, específicos para listas.</p> <p>Usando o <code>ListIterator</code>, você pode, por exemplo, adicionar um elemento na lista ou voltar para o elemento que foi "iterado" anteriormente.</p> </div> <div class="box"> <h4>Usar Iterator em vez do enhanced-for?</h4> <p>O <code>Iterator</code> pode sim ainda ser útil. Além de iterar na coleção como faz o enhanced-for, o <code>Iterator</code> consegue remover elementos da coleção durante a iteração de uma forma elegante, através do método <code>remove</code>.</p> </div> </section> <section class="section" data-section="16-11-mapas-java-util-map"> <a name="16-11-mapas-java-util-map" class="section-anchor"></a> <h2 class="section-title"> 16.11 - Mapas - java.util.Map </h2> <p>Muitas
 vezes queremos buscar rapidamente um objeto dado alguma informação 
sobre ele. Um exemplo seria, dada a placa do carro, obter todos os dados
 do carro. Poderíamos utilizar uma lista para isso e percorrer todos os 
seus elementos, mas isso pode ser péssimo para a performance, mesmo para
 listas não muito grandes. Aqui entra o mapa.</p> <p>Um mapa é composto 
por um conjunto de associações entre um objeto chave a um objeto valor. É
 equivalente ao conceito de dicionário, usado em várias linguagens. 
Algumas linguagens, como Perl ou PHP, possuem um suporte mais direto a 
mapas, onde são conhecidos como matrizes/arrays associativas.</p> <p><code>java.util.Map</code>
 é um mapa, pois é possível usá-lo para mapear uma chave a um valor, por
 exemplo: mapeie à chave "empresa" o valor "Caelum", ou então mapeie à 
chave "rua" ao valor "Vergueiro". Semelhante a associações de palavras 
que podemos fazer em um dicionário.</p> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/mapa.png" id="mapa.png" alt="mapa.png"> <p>O método <code>put(Object, Object)</code> da interface <code>Map</code>
 recebe a chave e o valor de uma nova associação. Para saber o que está 
associado a um determinado objeto-chave, passa-se esse objeto no método <code>get(Object)</code>. Sem dúvida essas são as duas operações principais e mais frequentes realizadas sobre um mapa.</p> <p>Observe o exemplo: criamos duas contas correntes e as colocamos em um mapa associando-as aos seus donos.</p> <pre><div class="highlight"><pre><span class="n">ContaCorrente</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
<span class="n">c1</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">10000</span><span class="o">);</span>
  
<span class="n">ContaCorrente</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
<span class="n">c2</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">3000</span><span class="o">);</span>
  
<span class="c1">// cria o mapa</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">ContaCorrente</span><span class="o">&gt;</span> <span class="n">mapaDeContas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
  
<span class="c1">// adiciona duas chaves e seus respectivos valores</span>
<span class="n">mapaDeContas</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"diretor"</span><span class="o">,</span> <span class="n">c1</span><span class="o">);</span>
<span class="n">mapaDeContas</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"gerente"</span><span class="o">,</span> <span class="n">c2</span><span class="o">);</span>

<span class="c1">// qual a conta do diretor? (sem casting!)</span>
<span class="n">ContaCorrente</span> <span class="n">contaDoDiretor</span> <span class="o">=</span> <span class="n">mapaDeContas</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"diretor"</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">contaDoDiretor</span><span class="o">.</span><span class="na">getSaldo</span><span class="o">());</span>
</pre></div></pre> <p>Um mapa é muito usado para "indexar" objetos de 
acordo com determinado critério, para podermos buscar esse objetos 
rapidamente. Um mapa costuma aparecer juntamente com outras coleções, 
para poder realizar essas buscas!</p> <p>Ele, assim como as coleções, trabalha diretamente com <code>Objects</code>
 (tanto na chave quanto no valor), o que tornaria necessário o casting 
no momento que recuperar elementos. Usando os generics, como fizemos 
aqui, não precisamos mais do casting.</p> <a id="HASHMAP"></a> <a id="TREEMAP"></a> <a id="HASHTABLE"></a> <p>Suas principais implementações são o <code>HashMap</code>, o <code>TreeMap</code> e o <code>Hashtable</code>.</p> <p>Apesar do mapa fazer parte do framework, ele não estende a interface <code>Collection</code>,
 por ter um comportamento bem diferente. Porém, as coleções internas de 
um mapa (a de chaves e a de valores, ver Figura 7) são acessíveis por 
métodos definidos na interface <code>Map</code>.</p> <img src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/map.png" id="map.png" alt="map.png"> <p>O método <code>keySet()</code> retorna um <code>Set</code> com as chaves daquele mapa e o método <code>values()</code> retorna a <code>Collection</code> com todos os valores que foram associados a alguma das chaves.</p> </section><div class="anuncio"> <a href="https://www.casadocodigo.com.br/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral" title="Editora Casa do Código"> <h4>Nova editora Casa do Código com livros de uma forma diferente</h4> <img class="icone" src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/casa-do-codigo_2x.png" aria-hidden="true" width="93"> <p>Editoras
 tradicionais pouco ligam para ebooks e novas tecnologias. Não conhecem 
programação para revisar os livros tecnicamente a fundo. Não têm anos de
 experiência em didáticas com cursos.<br>Conheça a <strong>Casa do Código</strong>, uma editora diferente, com curadoria da <strong>Caelum</strong> e obsessão por livros de qualidade a preços justos.</p> <p><span class="action">Casa do Código, ebook com preço de ebook</span>.</p> </a> </div> <section class="section" data-section="16-12-para-saber-mais-properties"> <a name="16-12-para-saber-mais-properties" class="section-anchor"></a> <h2 class="section-title"> 16.12 - Para saber mais: Properties </h2> <p>Um mapa importante é a tradicional classe <code>Properties</code>, que mapeia strings e é muito utilizada para a configuração de aplicações. </p> <p>A <code>Properties</code> possui, também, métodos para ler e gravar o mapeamento com base em um arquivo texto, facilitando muito a sua persistência.</p> <pre><div class="highlight"><pre><span class="n">Properties</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
  
<span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"database.login"</span><span class="o">,</span> <span class="s">"scott"</span><span class="o">);</span>
<span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"database.password"</span><span class="o">,</span> <span class="s">"tiger"</span><span class="o">);</span>
<span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"database.url"</span><span class="o">,</span><span class="s">"jdbc:mysql:/localhost/teste"</span><span class="o">);</span>

<span class="c1">// muitas linhas depois...</span>

<span class="n">String</span> <span class="n">login</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"database.login"</span><span class="o">);</span>
<span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"database.password"</span><span class="o">);</span>
<span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"database.url"</span><span class="o">);</span>
<span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">login</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
</pre></div></pre> <p>Repare que não houve a necessidade do casting para <code>String</code> no momento de recuperar os objetos associados. Isto porque a classe <code>Properties</code> foi desenhada com o propósito de trabalhar com a associação entre <code>Strings</code>.</p> </section> <section class="section" data-section="16-13-para-saber-mais-equals-e-hashcode"> <a name="16-13-para-saber-mais-equals-e-hashcode" class="section-anchor"></a> <h2 class="section-title"> 16.13 - Para saber mais: Equals e HashCode </h2> <p>Muitas
 das coleções do java guardam os objetos dentro de tabelas de hash. 
Essas tabelas são utilizadas para que a pesquisa de um objeto seja feita
 de maneira rápida.</p> <p>Como funciona? Cada objeto é "classificado" pelo seu <code>hashCode</code> e, com isso, conseguimos espalhar cada objeto agrupando-os pelo <code>hashCode</code>. Quando buscamos determinado objeto, só vamos procurar entre os elementos que estão no grupo daquele <code>hashCode</code>. Dentro desse grupo, vamos testando o objeto procurado com o candidato usando <code>equals()</code>.</p> <p>Para que isso funcione direito, o método <code>hashCode</code> de cada objeto deve retornar o mesmo valor para dois objetos, se eles são considerados <code>equals</code>. Em outras palavras:</p> <p><code>a.equals(b)</code> implica <code>a.hashCode() == b.hashCode()</code></p> <p>Implementar <code>hashCode</code> de tal maneira que ele retorne valores diferentes para dois objetos considerados <code>equals</code> quebra o contrato de <code>Object</code> e resultará em collections que usam espalhamento (como <code>HashSet</code>, <code>HashMap</code> e <code>Hashtable</code>), não achando objetos iguais dentro de uma mesma coleção.</p> <div class="box"> <h4>Equals e hashCode no Eclipse</h4> <p>O
 Eclipse é capaz de gerar uma implementação correta de equals e hashcode
 baseado nos atributos que você queira comparar. Basta ir no menu Source
 e depois em Generate hashcode() and equals().</p> </div> </section> <section class="section" data-section="16-14-para-saber-mais-boas-praticas"> <a name="16-14-para-saber-mais-boas-praticas" class="section-anchor"></a> <h2 class="section-title"> 16.14 - Para saber mais: Boas práticas </h2> <p>As
 coleções do Java oferecem grande flexibilidade ao usuário. A perda de 
performance em relação à utilização de arrays é irrelevante, mas deve-se
 tomar algumas precauções:</p> <ul> <li>Grande parte das coleções usam, 
internamente, um array para armazenar os seus dados. Quando esse array 
não é mais suficiente, é criada um maior e o conteúdo da antiga é 
copiado. Este processo pode acontecer muitas vezes, no caso de você ter 
uma coleção que cresce muito. Você deve, então, criar uma coleção já com
 uma capacidade grande, para evitar o excesso de redimensionamento.</li> <li>Evite usar coleções que guardam os elementos pela sua ordem de comparação quando não há necessidade. Um <code>TreeSet</code> gasta computacionalmente <code><strong>O(log(n))</strong></code> para inserir (ele utiliza uma árvore rubro-negra como implementação), enquanto o <code>HashSet</code> gasta apenas <code><strong>O(1)</strong></code>.</li> <li>Não itere sobre uma <code>List</code> utilizando um <code>for</code> de <code>0</code> até <code>list.size()</code> e usando <code>get(int)</code> para receber os objetos. Enquanto isso parece atraente, algumas implementações da <code>List</code> não são de acesso aleatório como a <code>LinkedList</code>, fazendo esse código ter uma péssima performance computacional. (use <code>Iterator</code>)</li> </ul> </section><div class="anuncio"> <a href="https://www.alura.com.br/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral" title="Cursos online Alura"> <h4>Já conhece os cursos online Alura?</h4> <img class="icone" src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/alura_2x.png" aria-hidden="true" width="120"> <p>A <strong>Alura</strong> oferece centenas de <strong>cursos online</strong> em sua plataforma exclusiva de ensino que favorece o aprendizado com a <strong>qualidade</strong>
 reconhecida da Caelum. Você pode escolher um curso nas áreas de Java, 
Front-end, Ruby, Web, Mobile, .NET, PHP e outros, com um plano que dá 
acesso a todos os cursos.</p> <p><span class="action">Conheça os cursos online Alura</span>.</p> </a> </div> <section class="section" data-section="16-15-exercicios-collections"> <a name="16-15-exercicios-collections" class="section-anchor"></a> <h2 class="section-title"> 16.15 - Exercícios: Collections </h2> <ol class="exercise"> <li class="question"> <p>Crie um código que insira 30 mil números numa <code>ArrayList</code> e pesquise-os. Vamos usar um método de <code>System</code> para cronometrar o tempo gasto:</p> <pre><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestaPerformance</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Iniciando..."</span><span class="o">);</span>
    <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">teste</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="kt">long</span> <span class="n">inicio</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
    
    <span class="kt">int</span> <span class="n">total</span> <span class="o">=</span> <span class="mi">30000</span><span class="o">;</span>
    
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">total</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">teste</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">total</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">teste</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kt">long</span> <span class="n">fim</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
    <span class="kt">long</span> <span class="n">tempo</span> <span class="o">=</span> <span class="n">fim</span> <span class="o">-</span> <span class="n">inicio</span><span class="o">;</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Tempo gasto: "</span> <span class="o">+</span> <span class="n">tempo</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Troque a <code>ArrayList</code> por um <code>HashSet</code> e verifique o tempo que vai demorar:</p> <pre><div class="highlight"><pre><span class="n">Collection</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">teste</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;&gt;();</span>
</pre></div></pre> <p>O que é lento? A inserção de 30 mil elementos ou as 30 mil buscas? Descubra computando o tempo gasto em cada <code>for</code> separadamente.</p> <p>A
 diferença é mais que gritante. Se você passar de 30 mil para um número 
maior, como 50 ou 100 mil, verá que isso inviabiliza por completo o uso 
de uma <code>List</code>, no caso em que queremos utilizá-la essencialmente em pesquisas.</p> </li> <li class="question"> <p>(conceitual, importante) Repare que, se você declarar a coleção e der <code>new</code> assim:</p> <pre><div class="highlight"><pre><span class="n">Collection</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">teste</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</pre></div></pre> <p>em vez de:</p> <pre><div class="highlight"><pre><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">teste</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</pre></div></pre> <p>É garantido que vai ter de alterar só essa linha para substituir a implementação por <code>HashSet</code>.
 Estamos aqui usando o polimorfismo para nos proteger que mudanças de 
implementação venham nos obrigar a alterar muito código. Mais uma vez: <em>programe voltado a interface, e não à implementação</em>! </p> <p>Esse é um <strong>excelente</strong>
 exemplo de bom uso de interfaces, afinal, de que importa como a coleção
 funciona? O que queremos é uma coleção qualquer, isso é suficiente para
 os nossos propósitos! Nosso código está com <strong>baixo acoplamento</strong> em relação a estrutura de dados utilizada: podemos trocá-la facilmente.</p> <p>Esse
 é um código extremamente elegante e flexível. Com o tempo você vai 
reparar que as pessoas tentam programar sempre se referindo a essas 
interfaces menos específicas, na medida do possível: métodos costumam 
receber e devolver <code>Collection</code>s, <code>List</code>s e <code>Set</code>s em vez de referenciar diretamente uma implementação. É o mesmo que ocorre com o uso de <code>InputStream</code> e <code>OutputStream</code>: eles são o suficiente, não há porque forçar o uso de algo mais específico. </p> <p>Obviamente,
 algumas vezes não conseguimos trabalhar dessa forma e precisamos usar 
uma interface mais específica ou mesmo nos referir ao objeto pela sua 
implementação para poder chamar alguns métodos. Por exemplo, <code>TreeSet</code> tem mais métodos que os definidos em <code>Set</code>, assim como <code>LinkedList</code> em relação à <code>List</code>. </p> <p>Dê um exemplo de um caso em que não poderíamos nos referir a uma coleção de elementos como <code>Collection</code>, mas necessariamente por interfaces mais específicas como <code>List</code> ou <code>Set</code>.</p> </li> <li class="question"> <p>Faça testes com o <code>Map</code>, como visto nesse capítulo:</p> <pre><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestaMapa</span> <span class="o">{</span>
  
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Conta</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
    <span class="n">c1</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">10000</span><span class="o">);</span>

    <span class="n">Conta</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContaCorrente</span><span class="o">();</span>
    <span class="n">c2</span><span class="o">.</span><span class="na">deposita</span><span class="o">(</span><span class="mi">3000</span><span class="o">);</span>

    <span class="c1">// cria o mapa</span>
    <span class="n">Map</span> <span class="n">mapaDeContas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>

    <span class="c1">// adiciona duas chaves e seus valores</span>
    <span class="n">mapaDeContas</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"diretor"</span><span class="o">,</span> <span class="n">c1</span><span class="o">);</span>
    <span class="n">mapaDeContas</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"gerente"</span><span class="o">,</span> <span class="n">c2</span><span class="o">);</span>

    <span class="c1">// qual a conta do diretor?</span>
    <span class="n">Conta</span> <span class="n">contaDoDiretor</span> <span class="o">=</span> <span class="o">(</span><span class="n">Conta</span><span class="o">)</span> <span class="n">mapaDeContas</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"diretor"</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">contaDoDiretor</span><span class="o">.</span><span class="na">getSaldo</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Depois, altere o código para usar o <em>generics</em> e não haver a necessidade do casting, além da garantia de que nosso mapa estará seguro em relação a tipagem usada.</p> <p>Você pode utilizar o <em>quickfix</em> do Eclipse para que ele conserte isso para você: na linha em que você está chamando o <code>put</code>, use o <code>ctrl + 1</code>. Depois de mais um quickfix (descubra!) seu código deve ficar como segue:</p> <pre><div class="highlight"><pre><span class="c1">// cria o mapa</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Conta</span><span class="o">&gt;</span> <span class="n">mapaDeContas</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
</pre></div></pre> <p>Que opção do <code>ctrl + 1</code> você escolheu para que ele adicionasse o <em>generics</em> para você?</p> </li> <li class="question"> <p>(opcional) Assim como no exercício 1, crie uma comparação entre <code>ArrayList</code> e <code>LinkedList</code>, para ver qual é a mais rápida para se adicionar elementos na primeira posição (<code>list.add(0, elemento)</code>), como por exemplo:</p> <pre><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestaPerformanceDeAdicionarNaPrimeiraPosicao</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Iniciando..."</span><span class="o">);</span>
    <span class="kt">long</span> <span class="n">inicio</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

    <span class="c1">// trocar depois por ArrayList        </span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">teste</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;&gt;();</span>
    
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">30000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">teste</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">i</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kt">long</span> <span class="n">fim</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
    <span class="kt">double</span> <span class="n">tempo</span> <span class="o">=</span> <span class="o">(</span><span class="n">fim</span> <span class="o">-</span> <span class="n">inicio</span><span class="o">)</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="o">;</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Tempo gasto: "</span> <span class="o">+</span> <span class="n">tempo</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Seguindo o mesmo raciocínio, você pode ver qual é a mais rápida para se percorrer usando o <code>get(indice)</code> (sabemos que o correto seria utilizar o <em>enhanced for</em> ou o <code>Iterator</code>). Para isso, insira 30 mil elementos e depois percorra-os usando cada implementação de <code>List</code>.</p> <p>Perceba
 que aqui o nosso intuito não é que você aprenda qual é o mais rápido, o
 importante é perceber que podemos tirar proveito do polimorfismo para 
nos comprometer apenas com a interface. Depois, quando necessário, 
podemos trocar e escolher uma implementação mais adequada as nossas 
necessidades.</p> <p>Qual das duas listas foi mais rápida para adicionar elementos à primeira posição?</p> </li> <li class="question"> <p>(opcional) Crie uma classe <code>Banco</code> que possui uma <code>List</code> de <code>Conta</code> chamada <code>contas</code>. Repare que numa lista de <code>Conta</code>, você pode colocar tanto <code>ContaCorrente</code> quanto <code>ContaPoupanca</code> por causa do polimorfismo. </p> <p>Crie um método <code>void adiciona(Conta c)</code>, um método <code>Conta pega(int x)</code> e outro <code>int pegaQuantidadeDeContas()</code>,
 muito similar à relação anterior de Empresa-Funcionário. Basta usar a 
sua lista e delegar essas chamadas para os métodos e coleções que 
estudamos.</p> <p>Como ficou a classe <code>Banco</code>?</p> </li> <li class="question"> <p>(opcional) No <code>Banco</code>, crie um método <code>Conta buscaPorNome(String nome)</code> que procura por uma <code>Conta</code> cujo <code>nome</code> seja <code>equals</code> ao <code>nome</code> dado.</p> <p>Você pode implementar esse método com um <code>for</code> na sua lista de <code>Conta</code>, porém não tem uma performance eficiente.</p> <p>Adicionando um atributo privado do tipo <code>Map&lt;String, Conta&gt;</code> terá um impacto significativo. Toda vez que o método <code>adiciona(Conta c)</code> for invocado, você deve invocar <code>.put(c.getNome(), c)</code> no seu mapa. Dessa maneira, quando alguém invocar o método <code>Conta buscaPorNome(String nome)</code>, basta você fazer o <code>get</code> no seu mapa, passando <code>nome</code> como argumento!</p> <p>Note,
 apenas, que isso é só um exercício! Dessa forma você não poderá ter 
dois clientes com o mesmo nome nesse banco, o que sabemos que não é 
legal.</p> <p>Como ficaria sua classe <code>Banco</code> com esse <code>Map</code>?</p> </li> <li class="question"> <p>(opcional, avançado) Crie o método <code>hashCode</code> para a sua conta, de forma que ele respeite o <code>equals</code> de que duas contas são <code>equals</code> quando tem o mesmo número. Felizmente para nós, o próprio Eclipse já vem com um criador de <code>equals</code> e <code>hashCode</code> que os faz de forma consistente.</p> <p>Na classe <code>Conta</code>, use o <code>ctrl + 3</code> e comece a escrever <em>hashCode</em> para achar a opção de gerá-los. Então, selecione apenas o atributo <code>número</code> e mande gerar o <code>hashCode</code> e o <code>equals</code>.</p> <p>Como ficou o código gerado?</p> </li> <li class="question"> <p>(opcional, avançado) Crie uma classe de teste e verifique se sua classe <code>Conta</code> funciona agora corretamente em um <code>HashSet</code>, isto é, que ela não guarda contas com números repetidos. Depois, remova o método <code>hashCode</code>. Continua funcionando?</p> <p>Dominar o uso e o funcionamento do <code>hashCode</code> é fundamental para o bom programador.</p> </li> </ol> </section> <section class="section" data-section="16-16-desafios"> <a name="16-16-desafios" class="section-anchor"></a> <h2 class="section-title"> 16.16 - Desafios </h2> <ol class="exercise"> <li class="question"><p>Gere todos os números entre 1 e 1000 e ordene em ordem decrescente utilizando um <code>TreeSet</code>. Como ficou seu código?</p></li> <li class="question"><p>Gere todos os números entre 1 e 1000 e ordene em ordem decrescente utilizando um <code>ArrayList</code>. Como ficou seu código?</p></li> </ol> </section> <section class="section" data-section="16-17-para-saber-mais-comparators-classes-anonimas-java-8-e-o-lambda"> <a name="16-17-para-saber-mais-comparators-classes-anonimas-java-8-e-o-lambda" class="section-anchor"></a> <h2 class="section-title"> 16.17 - Para saber mais: Comparators, classes anônimas, Java 8 e o lambda </h2> <p>E
 se precisarmos ordernar uma lista com outro critério de comparação? Se 
precisarmos alterar a própria classe e mudar seu método <code>compareTo</code>, teremos apenas uma forma de comparação por vez. Precisamos de mais!</p> <p>É possível definir outros critérios de ordenação usando a interface do <code>java.util</code> chamada <code>Comparator</code>. Existe um método <code>sort</code> em <code>Collections</code> que recebe, além da <code>List</code>, um <code>Comparator</code> definindo um critério de ordenação específico. É possível ter vários <code>Comparator</code>s com critérios diferentes para usar quando for necessário.</p> <p>Vamos criar um <code>Comparator</code> que serve para ordernar <code>Strings</code> de acordo com seu tamanho.</p> <pre><div class="highlight"><pre><span class="kd">class</span> <span class="nc">ComparadorPorTamanho</span> <span class="kd">implements</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">String</span> <span class="n">s1</span><span class="o">,</span> <span class="n">String</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">s1</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">s2</span><span class="o">.</span><span class="na">length</span><span class="o">())</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">s2</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">s1</span><span class="o">.</span><span class="na">length</span><span class="o">())</span>
      <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Repare que, diferente de <code>Comparable</code>, o método aqui se chama <code>compare</code> e recebe dois argumentos, já que quem o implementa não é o próprio objeto.</p> <p>Podemos deixá-lo mais curto, tomando proveito do método estático auxiliar <code>Integer.compare</code> que compara dois inteiros:</p> <pre><div class="highlight"><pre><span class="kd">class</span> <span class="nc">ComparadorPorTamanho</span> <span class="kd">implements</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">String</span> <span class="n">s1</span><span class="o">,</span> <span class="n">String</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">s1</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">l2</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></pre> <p>Depois, dentro do nosso código, teríamos uma chamada a <code>Collections.sort</code> passando o comparador também:</p> <pre><div class="highlight"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lista</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Sérgio"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Paulo"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Guilherme"</span><span class="o">);</span>

<span class="c1">// invocando o sort passando o comparador</span>
<span class="n">ComparadorPorTamanho</span> <span class="n">comparador</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ComparadorPorTamanho</span><span class="o">();</span>
<span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">lista</span><span class="o">,</span> <span class="n">comparador</span><span class="o">);</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lista</span><span class="o">);</span>
</pre></div></pre> <p>Como a variável temporária <code>comparador</code> é utilizada apenas aí, é comum escrevermos diretamente <code>Collections.sort(lista, new ComparadorPorTamanho())</code>.</p> <p></p> <h3>Escrevendo um Comparator com classe anônima</h3> <p>Repare que a classe <code>ComparadorPorTamanho</code>
 é bem pequena. É comum haver a necessidade de criar vários critérios de
 comparação, e muitas vezes eles são utilizados apenas num único ponto 
do nosso programa.</p> <p>Há uma forma de escrever essa classe e instanciá-la numa única instrução. Você faz isso dando <code>new</code> em <code>Comparator</code>. Mas como, se dissemos que uma interface não pode ser instanciada? Realmente <code>new Comparator()</code> não compila. Mas vai compilar se você abrir chaves e implementar tudo o que é necessário. Veja o código:</p> <pre><div class="highlight"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lista</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Sérgio"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Paulo"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Guilherme"</span><span class="o">);</span>


<span class="n">Comparator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">comparador</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
   <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">String</span> <span class="n">s1</span><span class="o">,</span> <span class="n">String</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">s1</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">l2</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">};</span>
<span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">lista</span><span class="o">,</span> <span class="n">comparador</span><span class="o">);</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lista</span><span class="o">);</span>
</pre></div></pre> <p>A sintaxe é realmente exdrúxula! Numa única linha 
nós definimos uma classe e a instanciamos! Uma classe que nem mesmo nome
 tem. Por esse motivo o recurso é chamado de classe anônima. Ele aparece
 com certa frequência, em especial para não precisar implementar 
interfaces que o código dos métodos seriam muito curtos e 
não-reutilizáveis. Você </p> <p>Há ainda como diminuir ainda mais o código, evitando a criação da variável temporária <code>comparador</code> e instanciando a interface dentro da invocação para o <code>sort</code>:</p> <pre><div class="highlight"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lista</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Sérgio"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Paulo"</span><span class="o">);</span>
<span class="n">lista</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Guilherme"</span><span class="o">);</span>

<span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">lista</span><span class="o">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
   <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">String</span> <span class="n">s1</span><span class="o">,</span> <span class="n">String</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">s1</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">l2</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">});</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lista</span><span class="o">);</span>
</pre></div></pre> <p>É realmente fácil se confundir com tantos 
parênteses e chaves em uma única instrução, mas você se habituará. Ese 
recurso costuma aparecer no desenvolvimento de <em>callbacks</em> para o Android e listeners na Web, por exemplo.</p> <p></p> <h3>Escrevendo um Comparator com lambda no Java 8</h3> <p>Você pode fazer o download do Java 8 aqui:</p> <p><a href="https://jdk8.java.net/download.html" rel="nofollow">https://jdk8.java.net/download.html</a></p> <p>O
 Eclipse já possui atualizações para compatibilidade com a nova versão, 
mas ele pode ser relativamente instável. Você pode utilizar a linha de 
comando, como fizemos no começo do curso, para esses testes, caso ache 
necessário.</p> <p>A partir dessa nova versão do Java há uma forma mais simples de obter esse mesmo <code>Comparator</code>. Repare:</p> <pre><div class="highlight"><pre><span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">lista</span><span class="o">,</span> <span class="o">(</span><span class="n">s1</span><span class="o">,</span> <span class="n">s2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">s1</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">l2</span><span class="o">.</span><span class="na">length</span><span class="o">));</span>
</pre></div></pre> <p>O código <code>(s1, s2) -&gt; Integer.compare(s1.length, l2.length)</code> gerará uma instância de <code>Comparator</code> que o <code>compare</code> devolve <code>Integer.compare(s1.length, l2.length)</code>. Até mesmo o <code>return</code> não é necessário, já que só temos uma instrução após o <code>-&gt;</code>. Esse é o recurso de lambda do Java 8.</p> <p>Uma outra novidade do Java 8 é a possibilidade de declarar métodos concretos dentro de uma interface, os chamados <em>default methods</em>. Até o Java 7 não existia <code>sort</code>
 em listas. Colocar um novo método abstrato em uma interface pode ter 
consequências drásticas: todo mundo que a implementava para de compilar!
 Mas colocar um método default não tem esse mesmo impacto devastador, já
 que as classes que implementama interface 'herdam' esse método. Então 
você pode fazer:</p> <pre><div class="highlight"><pre><span class="n">lista</span><span class="o">.</span><span class="na">sort</span><span class="o">((</span><span class="n">s1</span><span class="o">,</span> <span class="n">s2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">s1</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">l2</span><span class="o">.</span><span class="na">length</span><span class="o">));</span>
</pre></div></pre> <p>Há outros métodos nas coleções que utilizam do lambda para serem mais sucintos. </p> <p>Um deles é o <code>forEach</code>. Você pode fazer <code>lista.forEach(s -&gt; System.out.println(s))</code>.</p> <p>O <code>removeIf</code> é outro deles. Por exemplo, podemos escrever <code>lista.removeIf(c -&gt; c.getSaldo() &lt; 0)</code>. O <code>removeIf</code> recebe como argumento um objeto que implemente a interface <code>Predicate</code>, que possui apenas um método, que recebe um element e devolve <code>boolean</code>. Por possuir apenas um método abstrato também chamamos essa interface é uma interface funcional. O mesmo ocorre ao invocar o <code>forEach</code>, que recebe um argumento que implementa a interface funcional <code>Consumer</code>.</p> <p></p> <h3>Mais? Method references, streams e collectors</h3> <p>Trabalhar
 com lambdas no Java 8 vai muito além. Há diversos detalhes e recursos 
que não veremos nesse primeiro curso. Caso tenha curiosidade e queira 
saber mais, veja no blog:</p> <p><a href="http://blog.caelum.com.br/o-minimo-que-voce-deve-saber-de-java-8/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral">http://blog.caelum.com.br/o-minimo-que-voce-deve-saber-de-java-8/</a></p> </section><div class="anuncio"> <a href="http://www.galandra.com.br/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral" title="Pratique seu inglês no Galandra"> <h4>Saber inglês é muito importante em TI</h4> <img class="icone" src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/galandra_2x.png" aria-hidden="true" width="125"> <p>O <strong>Galandra</strong> auxilia a prática de inglês através de <i>flash cards</i> e <i>spaced repetition learning</i>. Conheça e aproveite os preços especiais.</p> <p><span class="action">Pratique seu inglês no Galandra</span>.</p> </a> </div> </div> <nav role="navigation" class="nav-simple container"> <div class="nav-simple-item"> <p class="nav-simple-type">Capítulo anterior:</p> <a href="https://www.caelum.com.br/apostila-java-orientacao-objetos/pacote-java-io/" class="nav-simple-chapter"> <span>Pacote java.io</span> </a> </div> <div class="nav-simple-item"> <p class="nav-simple-type">Próximo capítulo:</p> <a href="https://www.caelum.com.br/apostila-java-orientacao-objetos/programacao-concorrente-e-threads/" class="nav-simple-chapter"> <span>Programação Concorrente e Threads</span> </a> </div> </nav> <div class="container comunidade"> <h2 class="comunidade-chamada">Você encontra a Caelum também em:</h2> <ul class="comunidade-itens"> <li class="comunidade-item comunidade-blog"> <a href="http://blog.caelum.com.br/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral"> <span class="sp-comunidade sp-comunidade-blog"></span> <h3>Blog Caelum</h3> </a> </li> <li class="comunidade-item comunidade-online"> <a href="https://www.alura.com.br/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral"> <span class="sp-comunidade sp-comunidade-online"></span> <h3>Cursos Online</h3> </a> </li> <li class="comunidade-item comunidade-facebook"> <a href="http://facebook.com/caelumbr" rel="nofollow"> <span class="sp-comunidade sp-comunidade-facebook"></span> <h3>Facebook</h3> </a> </li> <li class="comunidade-item comunidade-newsletter"> <a href="http://www.caelum.com.br/newsletter/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral"> <span class="sp-comunidade sp-comunidade-newsletter"></span> <h3>Newsletter</h3> </a> </li> <li class="comunidade-item comunidade-editora"> <a href="https://www.casadocodigo.com.br/?utm_source=Apostila_HTML&amp;utm_campaign=FJ-11&amp;utm_medium=referral"> <span class="sp-comunidade sp-comunidade-editora"></span> <h3>Casa do Código</h3> </a> </li> <li class="comunidade-item comunidade-twitter"> <a href="http://twitter.com/caelum" rel="nofollow"> <span class="sp-comunidade sp-comunidade-twitter"></span> <h3>Twitter</h3> </a> </li> </ul> </div> <script>document.write('<iframe src="//4026389.fls.doubleclick.net/activityi;src=4026389;type=conve651;cat=;ord='+1e13*Math.random()+'?" width="1" height="1" frameborder="0" style="display:none"></iframe>')</script><iframe src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/activityi.html" style="display:none" width="1" frameborder="0" height="1"></iframe> <noscript> <iframe src="//4026389.fls.doubleclick.net/activityi;src=4026389;type=conve651;cat=;ord=1?"width="1"height="1"frameborder="0"style="display:none"></iframe> </noscript> <script>var google_conversion_id=995678627,google_conversion_label="DYcgCO3T_gMQo7Pj2gM",google_custom_params=window.google_tag_params,google_remarketing_only=!0</script> <script src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/conversion.js"></script> <noscript> <div style="display:inline"> <img height="1"width="1"style="border-style:none"alt=""src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/995678627/?value=0&amp;label=DYcgCO3T_gMQo7Pj2gM&amp;guid=ON&amp;script=0"> </div> </noscript> <script>var $mcGoal={settings:{uuid:"422bed2b74623ede65048a641",dc:"us1"}};!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.defer=!0,t.src=("https:"==document.location.protocol?"https://s3.amazonaws.com/downloads.mailchimp.com":"http://downloads.mailchimp.com")+"/js/goal.min.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script> <script src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/lead-tracking.js"></script> <script>LeadTracking.init({token:"4b7bbfbbbe5c7e29f1c12ecb3b59096b"})</script>  <div class="lead-capture-overlay"></div><iframe src="Collections%20framework%20-%20Java%20e%20Orienta%C3%A7%C3%A3o%20a%20Objetos_files/a.html" class="lead-capture-popup"></iframe></body></html>